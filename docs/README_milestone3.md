# Milestone 3: Managing account info

Now that we're storing our students' account and payment information, we need to help them update and delete it:
- People sometimes change their credit cards, email addresses, and names; they need to be able to reflect that in our records.  
- Letting people delete their account information is sometimes a legal requirement and always a best practice.  However, first we need to make sure our students have paid for all of their lessons.

## Requirements

### Updating account and payment information

Complete the Account Update page and implement a `POST /account-update/:customer_id` endpoint so that learners can update their name, email, and saved payment method.  We aren't collecting any payment, so use Setup Intents on this page just like the Lessons sign-up.
<br />

Update the Customer object using the Payment Method generated by the Setup Intent. This update replaces the Payment Method currently associated with the Customer.  Display the student's card details inside the `id="account-information"` element, both when the page is loaded and after a student saves a new Payment Method object.

If the student changes their name or email address, update those values on their Customer object.  If they try to use an email address already associated with another Customer, reveal the `id=customer-exists-error` element and display an error message saying "Customer email already exists".


### Checking for uncaptured payments, then delete the account
We don't need any user interface for account deletion, students can email us with their request.  

Complete the `POST /delete-account/:customer_id` endpoint so that it deletes the Stripe Customer object, but only if they have no uncaptured payments.  

It doesn't require any body parameters.

It can return three different responses:
- If the student has any uncaptured payments, then it returns a list of Payment Intent IDs.
- If the student has completed all of their payments, delete their Customer and return `deleted: true`.
- If there's an error, return details.

_Test locally by [setting up Playwright](../test/README.md), starting your application's client and server, and then running `npx playwright test ./specs/milestone3.spec.ts` in the repo's `./test` directory._